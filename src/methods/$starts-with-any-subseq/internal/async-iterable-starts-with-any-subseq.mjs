/**
 * @generated-from ./$iterable-starts-with-any-subseq.js
 * This file is autogenerated from a template. Please do not edit it directly.
 * To rebuild it from its template use the command
 * > npm run generate
 * More information can be found in CONTRIBUTING.md
 */

import { asyncEnsureSubseqs } from '../../../internal/async-ensure-subseqs';
import { asyncZipAll } from '../../$zip-all/async-zip-all';
import { simpleSlice } from '../../$slice/slice';
import { asyncWrap } from '../../$wrap/async-wrap';
const none = {};
const zipAllConfig = {
  filler: none,
};
export async function asyncIterableStartsWithAnySubseq(iterable, valueSubseqs, equals) {
  const valueArrays = await asyncEnsureSubseqs(valueSubseqs);
  const states = valueArrays.map(_ => ({
    matches: true,
    done: false,
  }));

  for await (const allItems of asyncZipAll(
    [iterable, ...valueArrays.map(asyncWrap)],
    zipAllConfig,
  )) {
    const item = allItems[0];
    let i = -1;
    let allDone = true;
    let anyMatched = false;

    for (const subseqItem of simpleSlice(allItems, 1, Infinity)) {
      const state = states[++i];
      state.done = subseqItem === none;
      state.matches = state.matches && equals(subseqItem, item);
      allDone = allDone && state.done;
      anyMatched = anyMatched || state.matches;
    }

    if (allDone) break;
    if (!anyMatched) return false;
  }

  return true;
}
